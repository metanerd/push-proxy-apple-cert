# Utility for renewal or creation of apple push notification certificate
## Description
Automate steps for certificate creation or renewal for apple push notification service. 

### Rough description of tasks:
1. Create a Certificate Signing Request to upload via apple portal and get it signed
1. Download the certificate and convert it so it becomes usable by [here](https://github.com/mattermost/mattermost-push-proxy)

### Result:
2 scripts, 2 manual steps: 
1. scripted creation of CSR via create_csr.go
1. manual upload of generated `certs/csr/*.go` file
1. manual download of signed `aps.cer` file from apple portal
1. scripted extraction + conversion from `aps.cer` to `certs/converted/*_priv.pem` to be then usable for mattermost-push-proxy

## Usage
### Prerequisites: 
```bash
$ openssl version
 OpenSSL 1.1.1  11 Sep 2018
```

```
$ GO111MODULE=on go get github.com/mattermost/push-proxy-apple-cert
```

### Steps
1. `$ cp .env.example .env`
1. Fill in input information in `.env`
1. `$ go run create_csr.go`
1. Follow https://developers.mattermost.com/contribute/mobile/push-notifications/ios/ to upload the Certificate Signing Request *.csr generated by the script
1. Download the `aps.cer` from the apple portal and put it in `certs/downloaded/aps.cer`
1. `$ go run convert_certificate.go`
1. Use `certs/converted/*_priv.pem` in the push proxy configuration as described [here](https://developers.mattermost.com/contribute/mobile/push-notifications/service/#set-up-mattermost-push-notification-service-to-send-ios-push-notifications)
